<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8">
<title>ワンクリ入力 → テキストコピー</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
  :root { --gap:10px; --pad:12px; }
  * { box-sizing: border-box; }
  body { font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Noto Sans JP", sans-serif; margin:16px; line-height:1.5; }
  h1 { font-size:18px; margin:0 0 8px; }
  .grid { display:grid; gap: var(--gap); }
  .card { border:1px solid #ddd; border-radius:12px; padding: var(--pad); }
  .row { display:flex; flex-wrap:wrap; gap:8px; align-items:center; }
  .btn { padding:8px 10px; border:1px solid #bbb; border-radius:10px; background:#fff; cursor:pointer; }
  .btn[data-active="1"] { border-color:#111; box-shadow:0 0 0 2px #111 inset; }
  .btn.small { padding:6px 8px; font-size:12px; }
  .chips { display:flex; flex-wrap:wrap; gap:6px; }
  .chip { padding:6px 10px; border:1px solid #ccc; border-radius:999px; cursor:pointer; background:#fff; }
  .chip[data-active="1"] { border-color:#111; box-shadow:0 0 0 2px #111 inset; }
  .num { display:flex; align-items:center; gap:6px; }
  .num .val { min-width:40px; text-align:right; font-variant-numeric: tabular-nums; }
  input[type="text"], input[type="number"] { padding:8px; border:1px solid #bbb; border-radius:10px; }
  .kbd { font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace; background:#f5f5f5; padding:2px 6px; border-radius:6px; border:1px solid #e6e6e6; }
  .muted { color:#666; font-size:12px; }
  textarea { width:100%; min-height:70px; padding:10px; border:1px solid #bbb; border-radius:10px; font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace; }
  .cols { display:grid; gap:10px; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); }
  .timegrid { display:grid; grid-template-columns: repeat(6, 1fr); gap:6px; }
  .mins    { display:grid; grid-template-columns: repeat(6, 1fr); gap:6px; }
  .footer { display:flex; gap:8px; flex-wrap:wrap; }
  .notice { font-size:12px; color:#0a0; display:none; }
</style>
</head>
<body>
  <h1>クリック入力 → 1行テキストをコピー</h1>
  <div class="grid">

    <!-- 時間 -->
    <div class="card">
      <div class="row" style="justify-content:space-between">
        <strong>時間</strong>
        <div class="row">
          <button class="btn small" id="btn-now">今</button>
          <button class="btn small" data-step="5"  data-ctrl="min-plus">+5分</button>
          <button class="btn small" data-step="5"  data-ctrl="min-minus">-5分</button>
        </div>
      </div>
      <div class="cols">
        <div>
          <div class="muted">時を選択</div>
          <div class="timegrid" id="hours"></div>
        </div>
        <div>
          <div class="muted">分を選択</div>
          <div class="mins" id="minutes"></div>
        </div>
      </div>
      <div class="row" style="margin-top:8px">
        <span class="muted">選択中：</span>
        <span id="time-view" class="kbd">--:--</span>
      </div>
    </div>

    <!-- 店名 -->
    <div class="card">
      <strong>店名</strong>
      <div id="shops" class="chips" style="margin-top:6px"></div>
      <div class="row" style="margin-top:8px">
        <input id="shop-input" type="text" placeholder="店名を入力して追加">
        <button class="btn" id="shop-add">＋追加</button>
      </div>
    </div>

    <!-- 機種 -->
    <div class="card">
      <strong>機種</strong>
      <div id="models" class="chips" style="margin-top:6px"></div>
      <div class="row" style="margin-top:8px">
        <input id="model-input" type="text" placeholder="機種名を入力して追加">
        <button class="btn" id="model-add">＋追加</button>
      </div>
    </div>

    <!-- 台番号 / 開始時データ -->
    <div class="card">
      <strong>台番号・開始時データ（BIG.REG.G）</strong>
      <div class="cols" style="margin-top:6px">
        <div class="row">
          <span class="muted">台番号</span>
          <input id="daino" type="number" inputmode="numeric" placeholder="例: 222" style="width:120px">
          <button class="btn small" data-ctrl="daino-clear">クリア</button>
        </div>
        <div class="row">
          <div class="num">
            <span>BIG</span>
            <button class="btn small" data-ctrl="big-minus">-1</button>
            <span class="val" id="big-val">0</span>
            <button class="btn small" data-ctrl="big-plus">+1</button>
            <button class="btn small" data-ctrl="big-reset">0</button>
          </div>
        </div>
        <div class="row">
          <div class="num">
            <span>REG</span>
            <button class="btn small" data-ctrl="reg-minus">-1</button>
            <span class="val" id="reg-val">0</span>
            <button class="btn small" data-ctrl="reg-plus">+1</button>
            <button class="btn small" data-ctrl="reg-reset">0</button>
          </div>
        </div>
        <div class="row">
          <div class="num">
            <span>G数</span>
            <button class="btn small" data-ctrl="g-minus-100">-100</button>
            <button class="btn small" data-ctrl="g-minus-10">-10</button>
            <span class="val" id="g-val">0</span>
            <button class="btn small" data-ctrl="g-plus-10">+10</button>
            <button class="btn small" data-ctrl="g-plus-100">+100</button>
            <button class="btn small" data-ctrl="g-reset">0</button>
          </div>
        </div>
      </div>
    </div>

    <!-- 出力 -->
    <div class="card">
      <div class="row" style="justify-content:space-between;">
        <strong>出力（1行）</strong>
        <div class="row">
          <label class="row"><input type="radio" name="fmt" value="text" checked> テキスト</label>
          <label class="row"><input type="radio" name="fmt" value="csv"> CSV</label>
        </div>
      </div>
      <textarea id="out" readonly></textarea>
      <div class="footer">
        <button class="btn" id="copy">コピー</button>
        <button class="btn" id="clear">クリア</button>
        <span id="copied" class="notice">コピーしました！</span>
      </div>
      <div class="muted" style="margin-top:6px">
        例（テキスト）：<span class="kbd">10:07 ZAPP高陽 新花火 台番180 開始 0.0.240</span><br>
        例（CSV）：<span class="kbd">10:07,ZAPP高陽,新花火,180,0,0,240</span>
      </div>
    </div>

  </div>

<script>
  // ===== プリセット（必要に応じて編集） =====
  const PRESET_SHOPS = ["ZAPP高陽", "スーパーランド", "タワービクトリー", "サンズビクトリー", "BB東雲", "ナイアガラ2"];
  const PRESET_MODELS = ["新花火", "マイジャグラー", "ハッピージャグラー", "ファンキージャグラー", "バーサス", "北斗", "マタドール"];

  // ===== 状態 =====
  const state = {
    hour: null, minute: null,
    shop: "", model: "",
    daino: "", big: 0, reg: 0, g: 0,
    fmt: "text"
  };

  // ===== ユーティリティ =====
  const z2 = n => String(n).padStart(2, "0");
  const clamp0 = n => Math.max(0, n|0);
  function renderTime() {
    const t = (state.hour==null || state.minute==null) ? "--:--" : `${z2(state.hour)}:${z2(state.minute)}`;
    document.getElementById("time-view").textContent = t;
  }
  function renderOutput() {
    let t = (state.hour==null || state.minute==null) ? "" : `${z2(state.hour)}:${z2(state.minute)}`;
    const daino = state.daino ? ` 台番${state.daino}` : "";
    const start = `${state.big}.${state.reg}.${state.g}`;
    const fmt = state.fmt;
    let line = "";
    if (fmt === "csv") {
      // 時間,店名,機種,台番号,開始BIG,開始REG,開始回転数
      line = [t, state.shop, state.model, state.daino, state.big, state.reg, state.g].join(",");
    } else {
      // テキスト
      line = `${t} ${state.shop} ${state.model}${daino} 開始 ${start}`.trim();
    }
    document.getElementById("out").value = line.replace(/\s+/g, " ").trim();
  }
  function setActive(container, value) {
    [...container.children].forEach(ch => ch.dataset.active = (ch.textContent === value) ? "1" : "0");
  }

  // ===== 時間UI生成 =====
  const hoursEl = document.getElementById("hours");
  for (let h=0; h<24; h++) {
    const b = document.createElement("button");
    b.className = "btn small";
    b.textContent = z2(h);
    b.onclick = () => { state.hour = h; renderTime(); renderOutput(); setActive(hoursEl, z2(h)); };
    hoursEl.appendChild(b);
  }
  const minutesEl = document.getElementById("minutes");
  const MIN_STEPS = [0,5,10,15,20,25,30,35,40,45,50,55];
  MIN_STEPS.forEach(m => {
    const b = document.createElement("button");
    b.className = "btn small";
    b.textContent = z2(m);
    b.onclick = () => { state.minute = m; renderTime(); renderOutput(); setActive(minutesEl, z2(m)); };
    minutesEl.appendChild(b);
  });
  document.getElementById("btn-now").onclick = () => {
    const d = new Date();
    state.hour = d.getHours(); state.minute = d.getMinutes() - (d.getMinutes() % 5);
    renderTime(); renderOutput();
    setActive(hoursEl, z2(state.hour));
    setActive(minutesEl, z2(state.minute));
  };
  document.querySelectorAll("[data-ctrl='min-plus'],[data-ctrl='min-minus']").forEach(btn=>{
    btn.onclick = () => {
      if (state.hour==null || state.minute==null) return;
      const step = parseInt(btn.dataset.step||"5",10) * (btn.dataset.ctrl.includes("minus")?-1:1);
      let total = state.hour*60 + state.minute + step;
      if (total<0) total = 0;
      if (total>23*60+55) total = 23*60+55;
      state.hour = Math.floor(total/60);
      state.minute = total%60 - (total%5);
      renderTime(); renderOutput();
      setActive(hoursEl, z2(state.hour));
      setActive(minutesEl, z2(state.minute));
    };
  });

  // ===== 店名・機種 chips =====
  function makeChips(list, mount, setter) {
    mount.innerHTML = "";
    list.forEach(txt=>{
      const el = document.createElement("div");
      el.className = "chip";
      el.textContent = txt;
      el.onclick = () => { setter(txt); };
      mount.appendChild(el);
    });
  }
  const shopsEl = document.getElementById("shops");
  const modelsEl = document.getElementById("models");
  let shops = [...PRESET_SHOPS];
  let models = [...PRESET_MODELS];

  function setShop(v){ state.shop = v; setActive(shopsEl, v); renderOutput(); }
  function setModel(v){ state.model = v; setActive(modelsEl, v); renderOutput(); }

  makeChips(shops, shopsEl, setShop);
  makeChips(models, modelsEl, setModel);

  document.getElementById("shop-add").onclick = ()=>{
    const v = document.getElementById("shop-input").value.trim();
    if(!v) return;
    shops.unshift(v);
    makeChips(shops, shopsEl, setShop);
    setShop(v);
    document.getElementById("shop-input").value = "";
  };
  document.getElementById("model-add").onclick = ()=>{
    const v = document.getElementById("model-input").value.trim();
    if(!v) return;
    models.unshift(v);
    makeChips(models, modelsEl, setModel);
    setModel(v);
    document.getElementById("model-input").value = "";
  };

  // ===== 台番号 & 開始データ =====
  const daino = document.getElementById("daino");
  daino.addEventListener("input", ()=>{ state.daino = daino.value.replace(/[^\d]/g,""); daino.value = state.daino; renderOutput(); });
  document.querySelector("[data-ctrl='daino-clear']").onclick = ()=>{ state.daino=""; daino.value=""; renderOutput(); };

  const bigVal = document.getElementById("big-val");
  const regVal = document.getElementById("reg-val");
  const gVal   = document.getElementById("g-val");
  function syncVals(){ bigVal.textContent=state.big; regVal.textContent=state.reg; gVal.textContent=state.g; renderOutput(); }

  const ctrls = {
    "big-plus": ()=>{ state.big = clamp0(state.big+1); },
    "big-minus": ()=>{ state.big = clamp0(state.big-1); },
    "big-reset": ()=>{ state.big = 0; },
    "reg-plus": ()=>{ state.reg = clamp0(state.reg+1); },
    "reg-minus": ()=>{ state.reg = clamp0(state.reg-1); },
    "reg-reset": ()=>{ state.reg = 0; },
    "g-plus-10": ()=>{ state.g = clamp0(state.g+10); },
    "g-plus-100": ()=>{ state.g = clamp0(state.g+100); },
    "g-minus-10": ()=>{ state.g = clamp0(state.g-10); },
    "g-minus-100": ()=>{ state.g = clamp0(state.g-100); },
    "g-reset": ()=>{ state.g = 0; }
  };
  document.querySelectorAll("[data-ctrl]").forEach(btn=>{
    const k = btn.dataset.ctrl;
    if (ctrls[k]) btn.onclick = ()=>{ ctrls[k](); syncVals(); };
  });

  // ===== 出力 =====
  document.querySelectorAll("input[name='fmt']").forEach(r=>{
    r.onchange = ()=>{ state.fmt = r.value; renderOutput(); };
  });

  document.getElementById("copy").onclick = async ()=>{
    const txt = document.getElementById("out").value;
    try { await navigator.clipboard.writeText(txt); } catch(e) {
      // フォールバック
      const ta = document.getElementById("out");
      ta.select(); document.execCommand("copy");
    }
    const n = document.getElementById("copied");
    n.style.display = "inline";
    setTimeout(()=> n.style.display = "none", 1200);
  };

  document.getElementById("clear").onclick = ()=>{
    state.hour = state.minute = null;
    state.shop = state.model = ""; state.daino = "";
    state.big = state.reg = state.g = 0;
    document.getElementById("daino").value = "";
    renderTime(); syncVals();
    setActive(shopsEl, "_"); setActive(modelsEl, "_");
    document.getElementById("out").value = "";
  };

  // 初期描画
  renderTime(); syncVals(); renderOutput();
</script>
</body>
</html>
