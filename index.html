<!doctype html>
<html lang="ja">
<meta charset="utf-8">
<title>ワンクリ入力（初期値プリセット版）</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
  :root{--b:#ddd;--g:10px}
  *{box-sizing:border-box} body{font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Noto Sans JP",sans-serif;margin:16px;line-height:1.5}
  h1{font-size:18px;margin:0 0 8px} .grid{display:grid;gap:var(--g)} .card{border:1px solid var(--b);border-radius:12px;padding:12px}
  .row{display:flex;gap:8px;flex-wrap:wrap;align-items:center} .chips{display:flex;gap:6px;flex-wrap:wrap}
  .btn{border:1px solid #bbb;border-radius:10px;background:#fff;padding:6px 10px;cursor:pointer}
  .chip{border:1px solid #bbb;border-radius:999px;padding:6px 10px;cursor:pointer;background:#fff}
  .active{box-shadow:0 0 0 2px #111 inset;border-color:#111}
  input[type="text"],input[type="number"]{border:1px solid #bbb;border-radius:10px;padding:8px}
  textarea{width:100%;min-height:90px;border:1px solid #bbb;border-radius:10px;padding:10px;font-family:ui-monospace,monospace}
  .cols{display:grid;gap:10px;grid-template-columns:repeat(auto-fit,minmax(220px,1fr))}
  .notice{font-size:12px;color:#0a0;display:none} .muted{color:#666;font-size:12px}
  .grid6{display:grid;grid-template-columns:repeat(6,1fr);gap:6px}
</style>

<h1>クリック入力 → 1行コピー（初期値プリセット）</h1>
<div class="grid">

  <!-- 時間 -->
  <div class="card">
    <div class="row" style="justify-content:space-between">
      <strong>時間</strong>
      <div class="row">
        <button class="btn" id="now">今</button>
        <button class="btn" data-min="+5">+5分</button>
        <button class="btn" data-min="-5">-5分</button>
      </div>
    </div>
    <div class="cols">
      <div><div class="muted">時（9-23）</div><div id="hours" class="grid6"></div></div>
      <div><div class="muted">分</div><div id="mins"  class="grid6"></div></div>
    </div>
    <div class="row" style="margin-top:6px"><span class="muted">選択中：</span><code id="timev">--:--</code></div>
  </div>

  <!-- 店名 -->
  <div class="card">
    <strong>店名</strong>
    <div id="shops" class="chips" style="margin-top:6px"></div>
    <div class="row" style="margin-top:6px">
      <input id="shop-in" placeholder="店名を入力して追加"><button class="btn" data-add="shop">＋追加</button>
    </div>
  </div>

  <!-- 機種 -->
  <div class="card">
    <strong>機種</strong>
    <div id="models" class="chips" style="margin-top:6px"></div>
    <div class="row" style="margin-top:6px">
      <input id="model-in" placeholder="機種名を入力して追加"><button class="btn" data-add="model">＋追加</button>
    </div>
  </div>

  <!-- 台・開始データ・投資 -->
  <div class="card">
    <strong>台番号・開始データ・投資</strong>
    <div class="cols" style="margin-top:6px">
      <div class="row"><span class="muted">台番号</span><input id="daino" type="number" inputmode="numeric" style="width:120px"><button class="btn" id="daino-clear">クリア</button></div>

      <div class="row" data-box="big"><label>BIG</label>
        <input class="num" data-key="big" type="number" min="0" value="0" style="width:110px">
        <button class="btn" data-inc="1">+1</button><button class="btn" data-inc="5">+5</button>
        <button class="btn" data-inc="10">+10</button><button class="btn" data-inc="30">+30</button>
        <button class="btn" data-reset>0</button>
      </div>

      <div class="row" data-box="reg"><label>REG</label>
        <input class="num" data-key="reg" type="number" min="0" value="0" style="width:110px">
        <button class="btn" data-inc="1">+1</button><button class="btn" data-inc="5">+5</button>
        <button class="btn" data-inc="10">+10</button><button class="btn" data-reset>0</button>
      </div>

      <div class="row" data-box="g"><label>G数</label>
        <input class="num" data-key="g" type="number" min="0" value="0" style="width:110px">
        <button class="btn" data-inc="1">+1</button><button class="btn" data-inc="10">+10</button>
        <button class="btn" data-inc="50">+50</button><button class="btn" data-inc="100">+100</button>
        <button class="btn" data-reset>0</button>
      </div>

      <div class="row" data-box="coin"><label>貯メダル(枚)</label>
        <input class="num" data-key="coin" type="number" min="0" value="0" style="width:120px">
        <button class="btn" data-inc="46">+46</button>
        <button class="btn" data-inc="10">+10</button><button class="btn" data-inc="50">+50</button>
        <button class="btn" data-inc="100">+100</button><button class="btn" data-reset>0</button>
      </div>

      <div class="row" data-box="cash"><label>現金(円)</label>
        <input class="num" data-key="cash" type="number" min="0" value="0" style="width:120px">
        <button class="btn" data-inc="1000">+1,000</button><button class="btn" data-inc="2000">+2,000</button>
        <button class="btn" data-inc="5000">+5,000</button><button class="btn" data-reset>0</button>
      </div>
    </div>
  </div>

  <!-- 出力 -->
  <div class="card">
    <div class="row" style="justify-content:space-between">
      <strong>出力（1行）</strong>
      <div class="row">
        <label class="row"><input type="radio" name="fmt" value="text" checked>テキスト</label>
        <label class="row"><input type="radio" name="fmt" value="csv">CSV</label>
      </div>
    </div>
    <textarea id="out" readonly></textarea>
    <div class="row">
      <button class="btn" id="copy">コピー</button>
      <button class="btn" id="clear">クリア</button>
      <span id="copied" class="notice">コピーしました！</span>
    </div>
  </div>
</div>

<script>
  // ===== 初期データ =====
  const SHOPS=["ZAPP高陽","スーパーランド","タワービクトリー","サンズビクトリー","BB東雲","ナイアガラ2"];
  const MODELS=["新花火","マイジャグラー","ハッピージャグラー","ファンキージャグラー","バーサス","北斗","マタドール"];
  const MIN_MINUTES=9*60, MAX_MINUTES=23*60+55;
  const S={h:null,m:null,shop:"",model:"",daino:"",big:0,reg:0,g:0,coin:0,cash:0,fmt:"text"};
  const z2=n=>String(n).padStart(2,"0"), clamp0=n=>Math.max(0,(parseInt(n,10)||0));
  const $=s=>document.querySelector(s);

  // ===== 時間 UI =====
  function initTime(){
    const H=$("#hours"),M=$("#mins");
    for(let i=9;i<=23;i++){ const b=document.createElement("button"); b.className="btn"; b.textContent=z2(i); b.dataset.hour=i; H.appendChild(b);}
    [0,5,10,15,20,25,30,35,40,45,50,55].forEach(v=>{const b=document.createElement("button"); b.className="btn"; b.textContent=z2(v); b.dataset.min=v; M.appendChild(b);});

    $("#now").onclick=()=>{ setNow(); markTime(); render(); }
    $("#hours").addEventListener("click",e=>{if(e.target.dataset.hour!=null){S.h=+e.target.dataset.hour; markTime(); render();}});
    $("#mins").addEventListener("click",e=>{if(e.target.dataset.min!=null){S.m=+e.target.dataset.min; markTime(); render();}});
    document.addEventListener("click",e=>{
      const d=e.target.dataset.min; if(!d||S.h==null||S.m==null)return;
      let tot=S.h*60+S.m+parseInt(d,10); tot=Math.min(Math.max(tot,MIN_MINUTES),MAX_MINUTES);
      S.h=Math.floor(tot/60); S.m=tot%60-(tot%5); markTime(); render();
    },true);

    function markTime(){ $("#timev").textContent=(S.h==null||S.m==null)?"--:--":`${z2(S.h)}:${z2(S.m)}`;
      [...H.children].forEach(b=>b.classList.toggle("active",+b.dataset.hour===S.h));
      [...M.children].forEach(b=>b.classList.toggle("active",+b.dataset.min===S.m)); }
  }
  function setNow(){
    const d=new Date(); let h=d.getHours(),m=d.getMinutes()-d.getMinutes()%5;
    if(h<9){h=9;m=0;} if(h>23){h=23;m=55;} S.h=h; S.m=m;
  }

  // ===== 店・機種 chips =====
  function makeChips(list,mountId,setKey){
    const el=$(mountId); el.innerHTML="";
    list.forEach(t=>{ const c=document.createElement("div"); c.className="chip"; c.textContent=t;
      c.onclick=()=>{S[setKey]=t;[...el.children].forEach(x=>x.classList.toggle("active",x===c)); render();};
      el.appendChild(c);});
  }

  // ===== 出力生成 =====
  function render(){
    const t=(S.h==null||S.m==null)?"":`${z2(S.h)}:${z2(S.m)}`, d=S.daino?` 台番${S.daino}`:"";
    const start=`${S.big}.${S.reg}.${S.g}`, invest=(S.coin||S.cash)?` 投資 ${S.coin}枚/${S.cash}円`:"";
    const line=S.fmt==="csv"
      ? [t,S.shop,S.model,S.daino,S.big,S.reg,S.g,S.coin,S.cash].join(",")
      : `${t} ${S.shop} ${S.model}${d} 開始 ${start}${invest}`.trim().replace(/\s+/g," ");
    $("#out").value=line;
    $("#timev").textContent=t||"--:--";
    [...$("#shops").children].forEach(ch=>ch.classList.toggle("active",ch.textContent===S.shop));
    [...$("#models").children].forEach(ch=>ch.classList.toggle("active",ch.textContent===S.model));
  }

  // ===== 初期化 =====
  window.addEventListener("DOMContentLoaded",()=>{
    initTime();
    makeChips(SHOPS,"#shops","shop");
    makeChips(MODELS,"#models","model");
    // 初期値をセット
    setNow();
    S.shop="ZAPP高陽";
    S.model="新花火";
    render();
  });

  // ===== 台番号・数値入力・コピー等（省略した前回部分そのまま） =====
  $("#daino").addEventListener("input",()=>{S.daino=$("#daino").value.replace(/[^\d]/g,"");$("#daino").value=S.daino;render();});
  $("#daino-clear").onclick=()=>{S.daino="";$("#daino").value="";render();};
  document.addEventListener("input",e=>{if(e.target.classList.contains("num")){S[e.target.dataset.key]=clamp0(e.target.value);render();}});
  document.addEventListener("click",e=>{
    const box=e.target.closest("[data-box]");if(!box)return;const key=box.dataset.box;
    if(e.target.hasAttribute("data-inc")){S[key]=clamp0(S[key]+parseInt(e.target.dataset.inc,10));box.querySelector(".num").value=S[key];render();}
    if(e.target.hasAttribute("data-reset")){S[key]=0;box.querySelector(".num").value=0;render();}
  });
  document.querySelectorAll("input[name='fmt']").forEach(r=>r.onchange=()=>{S.fmt=r.value;render();});
  $("#copy").onclick=async()=>{try{await navigator.clipboard.writeText($("#out").value);}catch(_){const ta=$("#out");ta.select();document.execCommand("copy");}
    const n=$("#copied");n.style.display="inline";setTimeout(()=>n.style.display="none",1000);};
  $("#clear").onclick=()=>{Object.assign(S,{h:null,m:null,shop:"",model:"",daino:"",big:0,reg:0,g:0,coin:0,cash:0});
    ["big","reg","g","coin","cash"].forEach(k=>document.querySelector(`[data-box="${k}"] .num`).value=0);
    $("#daino").value="";$("#timev").textContent="--:--";render();};
</script>
</html>
